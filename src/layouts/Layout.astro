---
interface Props {
  title?: string;
  description?: string;
}

const {
  title = 'Raveen Savinda Rathnayake — Software Engineer',
  description = 'Personal portfolio of Raveen Savinda Rathnayake — Associate Technical Lead at WSO2, Software Engineer, and Knowledge Sharer.',
} = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <meta name="author" content="Raveen Savinda Rathnayake" />

    <!-- Open Graph -->
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://raveen.me" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />

    <title>{title}</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />

    <!-- Theme script (runs before render to prevent flash) -->
    <script is:inline>
      (function () {
        const stored = localStorage.getItem('theme');
        if (stored) {
          document.documentElement.setAttribute('data-theme', stored);
        }
      })();
    </script>
  </head>
  <body>
    <div class="container">
      <slot />
    </div>

  </body>
</html>

<style is:global>
  @import '../styles/global.css';

</style>

<script>
  // --- Console message ---
  console.log(
    '%c\u{1F3CE}\uFE0F Sector 1: Clear\n\u{1F3C1} "Simply simply lovely"\n#3 // If you found this, we\'d get along.',
    'color: #e30613; font-size: 12px; font-weight: bold;'
  );

  // --- Tab title easter egg ---
  (function () {
    const originalTitle = document.title;
    document.addEventListener('visibilitychange', () => {
      document.title = document.hidden ? 'Box Box! \u{1F6DE}' : originalTitle;
    });
  })();

  // --- Konami code easter egg ---
  (function () {
    const code = ['ArrowUp','ArrowUp','ArrowDown','ArrowDown','ArrowLeft','ArrowRight','ArrowLeft','ArrowRight','b','a'];
    let index = 0;

    document.addEventListener('keydown', (e) => {
      const key = e.key.length === 1 ? e.key.toLowerCase() : e.key;
      if (key === code[index]) {
        index++;
        if (index === code.length) {
          index = 0;
          activateF1Mode();
        }
      } else {
        index = e.key === code[0] ? 1 : 0;
      }
    });

    function activateF1Mode() {
      console.log('Box box box! \u{1F3C1} Welcome to the grid.');

      // Shift accent to Red Bull red
      document.documentElement.style.setProperty('--accent', '#e30613');
      document.documentElement.style.setProperty('--accent-hover', '#c00510');

      setTimeout(() => {
        document.documentElement.style.removeProperty('--accent');
        document.documentElement.style.removeProperty('--accent-hover');
      }, 10000);

      // Show F1 toast
      const toast = document.getElementById('f1-toast');
      if (toast && toast.dataset.showing !== 'true') {
        toast.dataset.showing = 'true';
        toast.style.opacity = '1';
        toast.setAttribute('aria-hidden', 'false');

        setTimeout(() => {
          toast.style.opacity = '0';
          toast.setAttribute('aria-hidden', 'true');
          toast.dataset.showing = 'false';
        }, 8000);
      }
    }
  })();
</script>
